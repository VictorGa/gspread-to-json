{"version":3,"sources":["../develop/server.js"],"names":[],"mappings":"AAAA,YAAY,CAAC;;uBAIS,YAAY;;AAFlC,MAAM,CAAC,MAAM,GAAG,OAAO,CAAC,mBAAmB,CAAC,CAAC;;AAI7C,IAAI,OAAO,GAAG,OAAO,CAAC,SAAS,CAAC,CAAC;AACjC,IAAI,GAAG,GAAG,OAAO,EAAE,CAAC;AACpB,IAAI,QAAQ,GAAG,OAAO,CAAC,UAAU,CAAC,CAAC;AACnC,IAAI,EAAE,GAAG,OAAO,CAAC,IAAI,CAAC,CAAC;;AAEvB,GAAG,CAAC,MAAM,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,IAAI,IAAI,CAAC,CAAC;;AAGrC,GAAG,CAAC,GAAG,CAAC,YAAY,EAAE,UAAS,GAAG,EAAE,GAAG,EACvC;AACC,QAAO,CAAC,GAAG,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;AAC3B,KAAI,YAAY,GAAG,EAAE,CAAC;AACtB,IAAG,CAAC,MAAM,CAAC,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,UAAA,EAAE,EAAI;AACtC,cAAY,CAAC,IAAI,CAAC,EAAC,EAAE,EAAE,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE,WAAW,EAAE,KAAK,EAAC,CAAC,CAAC;EAC5D,CAAC,CAAC;AACH,IAAG,CAAC,SAAS,CAAC,6BAA6B,EAAC,GAAG,CAAC,CAAC;;AAEjD,IAAG,CAAC,SAAS,CAAC,GAAG,EAAE;AAClB,gBAAc,EAAE,iBAAiB;AACjC,uBAAqB,EAAE,kCAAkC;EACzD,CAAC,CAAC;;AAEH,KAAI,GAAG,GAAG,QAAQ,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC;;;AAG9B,IAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;;AAEd,uBAAQ,YAAY,EAAE,UAAC,QAAQ,EAAG;AACjC,QAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,UAAA,MAAM,EAAI;AACvC,WAAQ,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,UAAA,IAAI,EAAG;AAC/B,OAAG,CAAC,MAAM,CAAC,EAAE,CAAC,gBAAgB,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,EAAC,IAAI,EAAE,MAAM,GAAG,GAAG,GAAG,IAAI,CAAC,IAAI,EAAC,CAAC,CAAC;IAC7E,CAAC,CAAC;GACH,CAAC,CAAC;;AAEH,KAAG,CAAC,QAAQ,EAAE,CAAC;EACf,CAAC,CAAC;CACH,CAAC,CAAC;;AAEH,GAAG,CAAC,IAAI,CAAC,QAAQ,EAAC,UAAS,GAAG,EAAC,GAAG,EAAC;;AAElC,QAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;CACjB,CAAC,CAAC","file":"server.js","sourcesContent":["'use strict';\r\n\r\nGLOBAL.config = require('../gspreadfile.js');\r\n\r\nimport {execute} from './src/main';\r\n\r\nlet express = require('express');\r\nlet app = express();\r\nlet Archiver = require('archiver');\r\nlet fs = require('fs');\r\n\r\napp.listen(process.env.PORT || 3412);\r\n\r\n\r\napp.get('/parse/:id', function(req, res)\r\n{\r\n\tconsole.log(req.params.id);\r\n\tlet spreadsheets = [];\r\n\treq.params.id.split(',').forEach(id => {\r\n\t\tspreadsheets.push({id: id, name: null, cleanSpaces: false});\r\n\t});\r\n\tres.setHeader('Access-Control-Allow-Origin','*');\r\n\t// Tell the browser that this is a zip file.\r\n\tres.writeHead(200, {\r\n\t\t'Content-Type': 'application/zip',\r\n\t\t'Content-disposition': 'attachment; filename=gspread.zip'\r\n\t});\r\n\r\n\tvar zip = Archiver('zip', {});\r\n\r\n\t// Send the file to the page output.\r\n\tzip.pipe(res);\r\n\r\n\texecute(spreadsheets, (fileUrls)=>{\r\n\t\tObject.keys(fileUrls).forEach(folder => {\r\n\t\t\tfileUrls[folder].forEach(file =>{\r\n\t\t\t\tzip.append(fs.createReadStream(file.path), {name: folder + '/' + file.name});\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tzip.finalize();\r\n\t});\r\n});\r\n\r\napp.post('/parse',function(req,res){\r\n\r\n\tconsole.log(req);\r\n});"]}