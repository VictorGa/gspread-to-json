{"version":3,"sources":["../../develop/src/RelationParser.js"],"names":[],"mappings":";;;;;;;;;;;;;uBAAoB,WAAW;;;;AAE/B,IAAM,UAAU,GAAG,YAAY,CAAC;AAChC,IAAM,OAAO,GAAG,SAAS,CAAC;;AAEnB,IAAM,IAAI,GAAG;AACnB,MAAK,EAAE,IAAI;AACX,KAAI,EAAE,IAAI;AACV,KAAI,EAAE,KAAK;CACX,CAAC;;;;;;;;;AAOK,SAAS,cAAc,CAAC,SAAS,EACxC;AACC,KAAI,eAAe,GAAG,SAAS,CAAC,GAAG,CAAC,UAAA,QAAQ,EAC5C;AACC,MAAI,SAAS,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,QAAQ,CAAC,CAAC;AAC5C,MAAI,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC;AAC9B,MAAG,QAAQ,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,EAC9C;AACC,eAAY,GAAG,IAAI,CAAC,IAAI,CAAC;GACzB,MACI,IAAG,QAAQ,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,EACnD;AACC,eAAY,GAAG,IAAI,CAAC,IAAI,CAAC;GACzB;;AAED,MAAI,GAAG,GAAG,QAAQ,CAAC,QAAQ,CAAC,KAAK,CAAC,YAAY,CAAC,CAAC,GAAG,CAAC,UAAA,CAAC;UAAI,qBAAQ,QAAQ,CAAC,qBAAQ,WAAW,CAAC,CAAC,CAAC,CAAC;GAAA,CAAC,CAAC;AACnG,WAAS,CAAC,QAAQ,GAAG,GAAG,CAAC;AACzB,WAAS,CAAC,IAAI,GAAG,YAAY,CAAC;;AAE9B,SAAO,SAAS,CAAC;EACjB,CAAC,CAAC;;AAEH,QAAO,eAAe,CAAC;CACvB;;;;;;;;;AAQM,SAAS,cAAc,CAAC,SAAS,EAAE,IAAI,EAC9C;AACC,UAAS,CAAC,OAAO,CAAC,UAAA,QAAQ,EAC1B;;AAEC,MAAI,IAAI,GAAG,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;AAC/B,MAAI,IAAI,GAAG,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;;0CACZ,QAAQ,CAAC,QAAQ;;MAA/B,IAAI;MAAE,IAAI;;AAEf,MAAG,OAAO,IAAI,KAAK,WAAW,IAAI,OAAO,IAAI,KAAK,WAAW,EAC7D;AACC,UAAO,CAAC,KAAK,CAAC,WAAW,GAAG,QAAQ,CAAC,IAAI,GAAG,IAAI,GAAG,QAAQ,CAAC,IAAI,GAAG,iBAAiB,CAAC,CAAC;GACtF;;;AAGD,MAAI,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,UAAA,GAAG,EAC7B;AACC,OAAI,IAAI,GAAG,GAAG,CAAC,IAAI,CAAC,CAAC;AACrB,OAAI,UAAU,YAAA,CAAC;;AAEf,OAAG,OAAO,IAAI,KAAK,OAAO,EAC1B;AACC,cAAU,GAAG,IAAI,CAAC,GAAG,CAAC,UAAA,GAAG;YAAI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,UAAA,GAAG;aAAI,GAAG,CAAC,IAAI,CAAC,KAAK,GAAG;MAAA,CAAC;KAAA,CAAC,CAAC,MAAM,CAAC,UAAA,GAAG;YAAI,OAAO,GAAG,KAAK,WAAW;KAAA,CAAC,CAAC;IACjH,MAED;AACC,cAAU,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,UAAA,GAAG;YAAI,GAAG,CAAC,IAAI,CAAC,KAAK,IAAI;KAAA,CAAC,CAAC;IACvD;;AAED,MAAG,CAAC,IAAI,CAAC,GAAG,UAAU,CAAC;;AAEvB,UAAO,GAAG,CAAC;GACX,CAAC,CAAC;;AAEH,MAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC;EAC3B,CAAC,CAAC;CACH","file":"RelationParser.js","sourcesContent":["import Parsers from './Parsers';\n\nconst tabInclude = 'tabInclude';\nconst tabFrom = 'tabFrom';\n\nexport const type = {\n\tRIGHT: '->',\n\tLEFT: '<-',\n\tBOTH: '<->'\n};\n\n/**\n * Parse relation tab to a object\n * @param relations\n * @returns {Array}\n */\nexport function parseRelations(relations)\n{\n\tlet relationsParsed = relations.map(relation =>\n\t{\n\t\tlet relParsed = Object.assign({}, relation);\n\t\tlet relationType = type.RIGHT;\n\t\tif(relation.relation.indexOf(type.LEFT) !== -1)\n\t\t{\n\t\t\trelationType = type.LEFT;\n\t\t}\n\t\telse if(relation.relation.indexOf(type.BOTH) !== -1)\n\t\t{\n\t\t\trelationType = type.BOTH;\n\t\t}\n\n\t\tlet rel = relation.relation.split(relationType).map(r => Parsers.camelize(Parsers.cleanSpaces(r)));\n\t\trelParsed.relation = rel;\n\t\trelParsed.type = relationType;\n\n\t\treturn relParsed;\n\t});\n\n\treturn relationsParsed;\n}\n\n/**\n * Based on relation object, create relations\n * populating the right tab with the objects related to\n * @param relations\n * @param tabs\n */\nexport function applyRelations(relations, tabs)\n{\n\trelations.forEach(relation =>\n\t{\n\n\t\tlet tabA = tabs[relation.tabA];\n\t\tlet tabB = tabs[relation.tabB];\n\t\tlet [keyA, keyB] = relation.relation;\n\n\t\tif(typeof tabA === 'undefined' || typeof tabB === 'undefined')\n\t\t{\n\t\t\tconsole.error('Relation ' + relation.tabA + '->' + relation.tabB + ' does not exist');\n\t\t}\n\n\t\t//TabA includes element from TabB\n\t\ttabA.rows = tabA.rows.map(row =>\n\t\t{\n\t\t\tlet keys = row[keyA];\n\t\t\tlet keyObjects;\n\n\t\t\tif(typeof keys === 'Array')\n\t\t\t{\n\t\t\t\tkeyObjects = keys.map(key => tabB.rows.find(row => row[keyB] === key)).filter(row => typeof row !== 'undefined');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tkeyObjects = tabB.rows.find(row => row[keyB] === keys);\n\t\t\t}\n\n\t\t\trow[keyA] = keyObjects;\n\n\t\t\treturn row;\n\t\t});\n\n\t\ttabs[relation.tabA] = tabA;\n\t});\n}"]}