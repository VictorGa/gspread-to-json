{"version":3,"sources":["../../develop/src/TabUtils.js"],"names":[],"mappings":"AAAA,YAAY,CAAC;;;;;;;;;;;;uBACO,WAAW;;;;yBACX,aAAa;;AAEjC,IAAM,OAAO,GAAG,QAAQ,CAAC;AACzB,IAAM,WAAW,GAAG,aAAa,CAAC;;;;;;;;AAO3B,SAAS,QAAQ,CAAC,GAAG,EAC5B;AACC,KAAI,MAAM,GAAG,EAAE,CAAC;AAChB,OAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,UAAA,GAAG,EAC5B;AACC,QAAM,CAAC,GAAG,CAAC,GAAG,sBAAM,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;EAC9B,CAAC,CAAC;;AAEH,QAAO,MAAM,CAAC;CACd;;;;;;;;;AAQM,SAAS,gBAAgB,CAAC,MAAM,EAAE,GAAG,EAC5C;AACC,KAAG,OAAO,GAAG,CAAC,EAAE,KAAK,WAAW,EAChC;AACC,MAAI,KAAK,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,GAAG,CAAC,CAAC;AACnC,SAAO,KAAK,CAAC,EAAE,CAAC;;AAEhB,SAAO,CAAC,GAAG,CAAC,MAAM,EAAC,MAAM,CAAC,CAAC;AAC3B,QAAM,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC;EACvB;CACD;;;;;;;;;;AASM,SAAS,QAAQ,CAAC,WAAW,EAAE,GAAG,EACzC;AACC,KAAI,MAAM,GAAG,GAAG,CAAC,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC;AACzC,KAAI,UAAU,GAAG,GAAG,CAAC,OAAO,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC,CAAC;AACjD,KAAI,IAAI,YAAA,CAAC;AACT,KAAI,aAAa,GAAG,EAAE,CAAC;;;;AAIvB,KAAG,UAAU,EACb;AACC,MAAI,GAAG,EAAE,CAAC;AACV,aAAW,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,UAAA,GAAG;UAAI,qBAAQ,MAAM,CAAC,GAAG,CAAC,EAAE,EAAE,GAAG,CAAC,KAAK,EAAE,IAAI,CAAC;GAAA,CAAC,CAAC;EAC9E,MAED;AACC,QAAM,CAAC,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,UAAA,MAAM,EAAG;AACtD,OAAG,OAAO,aAAa,CAAC,MAAM,CAAC,KAAK,WAAW,EAC/C;AACC,iBAAa,CAAC,MAAM,CAAC,GAAG,EAAE,CAAC;IAC3B;;AAED,OAAI,MAAM,GAAG,WAAW,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;AAC9C,SAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,UAAA,YAAY,EACxC;AACC,UAAM,CAAC,YAAY,CAAC,CAAC,OAAO,CAAC,UAAA,KAAK,EAAG;AACpC,kBAAa,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,QAAQ,qBAAG,YAAY,EAAG,KAAK,EAAE,CAAC,CAAC;KAC9D,CAAC,CAAA;IACF,CAAC,CAAC;GACH,CAAC,CAAC;;AAEH,MAAI,GAAG,WAAW,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,UAAA,GAAG;UAAI,QAAQ,CAAC,GAAG,CAAC;GAAA,CAAC,CAAC;;;AAGvD,SAAO,CAAC,GAAG,CAAC,aAAa,EAAE,aAAa,CAAC,CAAA;EACzC;;AAED,4BAAS,GAAG,EAAG,EAAC,IAAI,EAAJ,IAAI,EAAE,MAAM,EAAN,MAAM,EAAE,UAAU,EAAV,UAAU,EAAE,aAAa,EAAb,aAAa,EAAE,WAAW,EAAE,OAAO,WAAW,CAAC,GAAG,CAAC,CAAC,OAAO,KAAK,WAAW,EAAC,EAAE;CACxH","file":"TabUtils.js","sourcesContent":["'use strict';\nimport Parsers from './Parsers';\nimport {parse} from './Tokenizer';\n\nconst dictKey = '__dict';\nconst objParseKey = '__obj_parse';\n\n/**\n * For each row parse content applying rules\n * @param row\n * @returns {{}}\n */\nexport function parseRow(row)\n{\n\tlet parsed = {};\n\tObject.keys(row).forEach(key =>\n\t{\n\t\tparsed[key] = parse(row[key]);\n\t});\n\n\treturn parsed;\n}\n\n/**\n * Set the whole row as dictionary\n * [id] : data\n * @param parent\n * @param row\n */\nexport function convertRowToDict(parent, row)\n{\n\tif(typeof row.id !== 'undefined')\n\t{\n\t\tlet clone = Object.assign({}, row);\n\t\tdelete clone.id;\n\n\t\tconsole.log('>>> ',parent);\n\t\tparent[row.id] = clone;\n\t}\n}\n\n/**\n * Parse spreadsheet tab.\n * Loop each tab's row and apply regexs\n * @param spreadsheet\n * @param tab\n * @returns {{}}\n */\nexport function parseTab(spreadsheet, tab)\n{\n\tlet isDict = tab.indexOf(dictKey) !== -1;\n\tlet isObjParse = tab.indexOf(objParseKey) !== -1;\n\tlet rows;\n\tlet localizedRows = {};\n\n\t//In case is a object should be deepened\n\t//Just couples of id-copy\n\tif(isObjParse)\n\t{\n\t\trows = {};\n\t\tspreadsheet[tab].rows.forEach(row => Parsers.deepen(row.id, row.value, rows));\n\t}\n\telse\n\t{\n\t\tObject.keys(spreadsheet[tab].locales).forEach(locale =>{\n\t\t\tif(typeof localizedRows[locale] === 'undefined')\n\t\t\t{\n\t\t\t\tlocalizedRows[locale] = [];\n\t\t\t}\n\n\t\t\tlet values = spreadsheet[tab].locales[locale];\n\t\t\tObject.keys(values).forEach(propertyName =>\n\t\t\t{\n\t\t\t\tvalues[propertyName].forEach(value =>{\n\t\t\t\t\tlocalizedRows[locale].push(parseRow({[propertyName]: value}));\n\t\t\t\t})\n\t\t\t});\n\t\t});\n\n\t\trows = spreadsheet[tab].rows.map(row => parseRow(row));\n\n\t\t//Locales\n\t\tconsole.log('>>> locales', localizedRows)\n\t}\n\n\treturn {[tab]: {rows, isDict, isObjParse, localizedRows, isLocalized: typeof spreadsheet[tab].locales !== 'undefined'}};\n}"]}